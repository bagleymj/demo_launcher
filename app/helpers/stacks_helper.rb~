module StacksHelper
  def get_public_ip(stack_name)
    resp = @cloudformation.list_stack_resources(stack_name: stack_name)
    resources = resp[0]
    ip_resource = resources.select{|resource| resource.logical_resource_id == 'demoPublcIP'}
    if ip_resource[0].nil?
      ip_address = '--loading--'
    else
      ip_address = ip_resource[0].physical_resource_id
    end
    return ip_address
  end

  def get_stack_status(stack_name)
    resp = @cloudformation.describe_stacks({stack_name: stack_name})
    stack_status = resp[0].stack[0].stack_status
    return stack_status
  end

#  def new_client
#    access_key_id = Account.all[0].access_key_id
#    secret_access_key = Account.all[0].secret_access_key
#    cloudformation = Aws::CloudFormation::Client.new(access_key_id: access_key_id, 
#                                                     secret_access_key: secret_access_key)
#    return cloudformation
#  end
end

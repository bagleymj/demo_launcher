  <%= render 'loading_bar' %> 
  <div class="row">
    <table class="table table-striped">
      <tr>
        <th>
          Stack Name
        </th>
        <% if is_admin? %>
          <th>
            Stack Template
          </th>
          <th>
            Company
          </th>
        <% end %>
        <th>
          Remote Desktop IP
        </th>
        <th>
          Server State
        </th>
        <% if is_admin? %>
          <th>
            Stack Status
          </th>
        <% end %>
        <th>
          Actions
        </th>
      </tr>
      <% @stacks.each do |stack| %>
        <tr>
          <td>
            <% if get_stack_status(stack.stack_name) == "CREATE_COMPLETE" %>
              <%= link_to stack.stack_name, stack_path(stack.id) %>
            <% else %>
              <%= stack.stack_name %>
            <% end %>
          </td>
          <% if is_admin? %>
            <td>
              <%= stack.template.template_name %>
            </td>
            <td>
              <%= stack.company.company_name %>
            </td>
          <% end %>
          <td>
            <%= get_public_ip(stack.stack_name) %>
          </td>
          <td>
            <%= get_pretty_instance_count(stack.stack_name) %>
          </td>
          <% if is_admin? %>
            <td>
              <%= get_stack_status(stack.stack_name) %> 
            </td>
          <% end %>
          <td>
            <div class="btn-group">
            <% if stack_created?(stack.stack_name) %>
              <% if all_servers_not_started?(stack.stack_name) %>
                <div style="width:auto; float:left">
                  <%= button_to "Start", {:action => 'start_instances', :id => stack.id}, :method => :post, class: 'btn btn-success', :data => {toggle: "modal", target:"#loadingBar"} %>
                </div>
              <% end %>
              <% if servers_running?(stack.stack_name) %>
                <div style="width:auto; float:left">
                  <%= button_to "Stop", {:action => 'stop_instances', :id => stack.id}, :method => :post, class: 'btn btn-warning', :data => {toggle: "modal", target: "#loadingBar"}  %>
                </div>
              <% end %>
              <% if is_admin? %>
                <div style="width:auto; float:left">
                  <%= button_to "Delete", stack, :method => :delete, class: 'btn btn-danger', :data => {toggle: "modal", target:"#loadingBar"} %>
                </div>
              <% end %>
            <% else  %>
              --loading--
            <% end %>
            </div>
          </td>
        </tr>
      <% end %>
    </table>
    <% if is_admin? %>
      <%= button_to "Create New Stack", new_stack_path, :method => :get, class: 'btn btn-success' %>
    <% end %>
    </div>
</div>
